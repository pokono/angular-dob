angular.module("angularDob",[]),angular.module("angularDob").factory("CommonDob",[function(){var e={};return e.parseDob=function(e){var t,r,a,n;return e=e||"",e=e.replace(/\s/g,""),n=e.split("/",3),t=n[1],r=n[0],a=n[2],t=parseInt(t,10),r=parseInt(r,10),a=parseInt(a,10),{day:t,month:r,year:a}},e.parseDate=function(e){var t,r,a,n;return e=e||"",e=e.replace(/\s/g,""),n=e.split("-",3),t=n[2],r=n[1],a=n[0],t=parseInt(t,10),r=parseInt(r,10),a=parseInt(a,10),{day:t,month:r,year:a}},e}]),angular.module("angularDob").factory("_FormatDob",["CommonDob","$filter",function(e,t){var r=function(e){var t;return null!=e.prop("selectionStart")&&e.prop("selectionStart")!==e.prop("selectionEnd")?!0:!("undefined"!=typeof document&&null!==document&&null!=(t=document.selection)&&"function"==typeof t.createRange?!t.createRange().text:!0)};_restrictDob=function(e){var t,a,n;return t=angular.element(e.currentTarget),a=String.fromCharCode(e.which),!/^\d+$/.test(a)&&!e.meta&&e.keyCode>=46?void e.preventDefault():r(t)?void 0:(n=t.val()+a,n=n.replace(/\D/g,""),n.length>8?void e.preventDefault():void 0)},_formatDob=function(e){var t,r,a;return r=String.fromCharCode(e.which),!/^\d+$/.test(r)&&!e.meta&&e.keyCode>=46?void e.preventDefault():(t=angular.element(e.currentTarget),a=t.val()+r,original=t.val(),/^\d$/.test(a)&&"0"!==a&&"1"!==a?(e.preventDefault(),t.val("0"+a+" / ")):/^\d\d$/.test(a)?(e.preventDefault(),t.val(""+a+" / ")):/^\d\d\s\/\s\d$/.test(a)&&"0"!==r&&"1"!==r&&"2"!==r&&"3"!==r?(e.preventDefault(),t.val(""+original+"0"+r+" / ")):/^\d\d\s\/\s\d\d$/.test(a)?(e.preventDefault(),t.val(""+a+" / ")):void 0)},_formatForwardDob=function(e){var t,r,a;return r=String.fromCharCode(e.which),!/^\d+$/.test(r)&&!e.meta&&e.keyCode>=46?void 0:(t=angular.element(e.currentTarget),a=t.val(),/^\d\d$/.test(a)?t.val(""+a+" / "):/^\d\d\s\/\s\d\d$/.test(a)?t.val(""+a+" / "):void 0)},_formatForwardSlash=function(e){var t,r,a;return r=String.fromCharCode(e.which),"/"===r?(t=angular.element(e.currentTarget),a=t.val(),/^\d$/.test(a)&&"0"!==a?t.val("0"+a+" / "):/^\d\d\s\/\s\d$/.test(a)?t.val(""+a+" / "):void 0):void 0},_formatBackDob=function(e){var t,r;if(!e.meta&&(t=angular.element(e.currentTarget),r=t.val(),8===e.which&&(null==t.prop("selectionStart")||t.prop("selectionStart")===r.length)))return/\d(\s|\/)+$/.test(r)?(e.preventDefault(),t.val(r.replace(/\d(\s|\/)*$/,""))):/\s\/\s?\d?$/.test(r)?(e.preventDefault(),t.val(r.replace(/\s\/\s?\d?$/,""))):void 0};var a=function(r){if(null!=r){var a=e.parseDob(r),n=new Date(a.year,a.month-1,a.day);return a.text=t("date")(n,"MM/dd/yyyy"),a}return null},n=function(r){if(null!=r){var a=e.parseDob(r),n=new Date(a.year,a.month-1,a.day);return t("date")(n,"MM / dd / yyyy")}return null};return function(e,t){e.bind("keypress",_restrictDob),e.bind("keypress",_formatDob),e.bind("keypress",_formatForwardSlash),e.bind("keypress",_formatForwardDob),e.bind("keydown",_formatBackDob),t.$parsers.push(a),t.$formatters.push(n)}}]).directive("dobFormat",["$window","_FormatDob",function(e,t){return{restrict:"A",require:"ngModel",link:function(e,r,a,n){t(r,n)}}}]),angular.module("angularDob").factory("_ValidateDob",["CommonDob",function(e){var t=function(t,r){if(null==t||0==t.length)return!0;var a,n=r.hasOwnProperty("dobValidateMaxDate")?r.dobValidateMaxDate:null,o=r.hasOwnProperty("dobValidateMinDate")?r.dobValidateMinDate:null,l=new Date,d=!0;if(void 0,void 0,void 0,"object"==typeof t?obj=e.parseDob(t.text):obj=e.parseDob(t),day=obj.day,month=obj.month,year=obj.year,!(month&&year&&day))return!1;if(!/^\d+$/.test(day))return!1;if(!/^\d+$/.test(month))return!1;if(!/^\d+$/.test(year))return!1;if(!(parseInt(month,10)<=12))return!1;if(a=new Date(year,month,day),a.getFullYear()!=year||a.getMonth()!=month||a.getDate()!=day)return!1;if(a.setMonth(a.getMonth()-1),d=l>a,n&&d){var u=e.parseDate(n);l=new Date(u.year,u.month-1,u.day),d=l>a}if(o&&d){var i=e.parseDate(o);l=new Date(i.year,i.month-1,i.day),d=a>l}return d};return function(e,r,a,n){return t(e,n)}}]).directive("dobValidate",["$window","_ValidateDob",function(e,t){return{restrict:"A",require:"ngModel",link:function(e,r,a,n){var o=a.dobValidate,l=function(r){var l=t(r,n,e,a);return n.$setValidity(o,l),l?r:void 0};n.$formatters.push(l),n.$parsers.push(l)}}}]);