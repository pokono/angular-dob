angular.module("angularDob",[]),angular.module("angularDob").factory("CommonDob",[function(){var e={};return e.MODE_MDY="mm/dd/yyyy",e.MODE_DMY="dd/mm/yyyy",e.mode=e.MODE_MDY,e.setMode=function(t){if(t)switch(t){case this.MODE_MDY:case this.MODE_DMY:e.mode=t;break;default:void 0}},e.isDMY=function(e){return this.mode==this.MODE_DMY},e.isMDY=function(e){return this.mode==this.MODE_MDY},e.parseDob=function(e){var t,r,a,n;return e=e||"",e=e.replace(/\s/g,""),n=e.split("/",3),this.isDMY()?(t=n[0],r=n[1]):(t=n[1],r=n[0]),a=n[2],t=parseInt(t,10),r=parseInt(r,10),a=parseInt(a,10),{day:t,month:r,year:a}},e.parseDate=function(e){var t,r,a,n;return e=e||"",e=e.replace(/\s/g,""),n=e.split("-",3),t=n[2],r=n[1],a=n[0],t=parseInt(t,10),r=parseInt(r,10),a=parseInt(a,10),{day:t,month:r,year:a}},e}]),angular.module("angularDob").factory("_FormatDob",["CommonDob","$filter",function(e,t){var r=function(e){var t;return null!=e.prop("selectionStart")&&e.prop("selectionStart")!==e.prop("selectionEnd")||!("undefined"==typeof document||null===document||null==(t=document.selection)||"function"!=typeof t.createRange||!t.createRange().text)};_restrictDob=function(e){var t,a,n;return t=angular.element(e.currentTarget),a=String.fromCharCode(e.which),!/^\d+$/.test(a)&&!e.meta&&e.keyCode>=46?void e.preventDefault():r(t)?void 0:(n=t.val()+a,n=n.replace(/\D/g,""),n.length>8?void e.preventDefault():void 0)},_formatDob=function(t){var r,a,n;if(a=String.fromCharCode(t.which),!/^\d+$/.test(a)&&!t.meta&&t.keyCode>=46)return void t.preventDefault();if(r=angular.element(t.currentTarget),n=r.val()+a,original=r.val(),e.isDMY()){if(/^\d$/.test(n)&&"0"!==n&&"1"!==n&&"2"!==n&&"3"!==n)return t.preventDefault(),r.val("0"+n+" / ");if(/^\d\d$/.test(n))return t.preventDefault(),r.val(""+n+" / ");if(/^\d\d\s\/\s\d$/.test(n)&&"0"!==a&&"1"!==a)return t.preventDefault(),r.val(""+original+"0"+a+" / ");if(/^\d\d\s\/\s\d\d$/.test(n))return t.preventDefault(),r.val(""+n+" / ")}else{if(/^\d$/.test(n)&&"0"!==n&&"1"!==n)return t.preventDefault(),r.val("0"+n+" / ");if(/^\d\d$/.test(n))return t.preventDefault(),r.val(""+n+" / ");if(/^\d\d\s\/\s\d$/.test(n)&&"0"!==a&&"1"!==a&&"2"!==a&&"3"!==a)return t.preventDefault(),r.val(""+original+"0"+a+" / ");if(/^\d\d\s\/\s\d\d$/.test(n))return t.preventDefault(),r.val(""+n+" / ")}},_formatForwardDob=function(e){var t,r,a;if(r=String.fromCharCode(e.which),/^\d+$/.test(r)||e.meta||!(e.keyCode>=46))return t=angular.element(e.currentTarget),a=t.val(),/^\d\d$/.test(a)?t.val(""+a+" / "):/^\d\d\s\/\s\d\d$/.test(a)?t.val(""+a+" / "):void 0},_formatForwardSlash=function(e){var t,r,a;if(r=String.fromCharCode(e.which),"/"===r)return t=angular.element(e.currentTarget),a=t.val(),/^\d$/.test(a)&&"0"!==a?t.val("0"+a+" / "):/^\d\d\s\/\s\d$/.test(a)?t.val(""+a+" / "):void 0},_formatBackDob=function(e){var t,r;if(!e.meta&&(t=angular.element(e.currentTarget),r=t.val(),8===e.which&&(null==t.prop("selectionStart")||t.prop("selectionStart")===r.length)))return/\d(\s|\/)+$/.test(r)?(e.preventDefault(),t.val(r.replace(/\d(\s|\/)*$/,""))):/\s\/\s?\d?$/.test(r)?(e.preventDefault(),t.val(r.replace(/\s\/\s?\d?$/,""))):void 0};var a=function(r){if(null!=r){var a=e.parseDob(r),n=new Date(a.year,a.month-1,a.day),o="";return o=e.isDMY()?"dd / MM / yyyy":"MM / dd / yyyy",a.text=t("date")(n,o),a}return null},n=function(r){if(null!=r){var a=null;switch(typeof r){case"string":a=e.parseDob(r);break;case"object":a=r}var n=new Date(a.year,a.month-1,a.day),o="";return o=e.isDMY()?"dd / MM / yyyy":"MM / dd / yyyy",t("date")(n,o)}return null};return function(t,r,o){e.setMode(o.dobFormatMode),t.bind("keypress",_restrictDob),t.bind("keypress",_formatDob),t.bind("keypress",_formatForwardSlash),t.bind("keypress",_formatForwardDob),t.bind("keydown",_formatBackDob),r.$parsers.push(a),r.$formatters.push(n)}}]).directive("dobFormat",["$window","_FormatDob",function(e,t){return{restrict:"A",require:"ngModel",link:function(e,r,a,n){t(r,n,a)}}}]),angular.module("angularDob").factory("_ValidateDob",["CommonDob",function(e){var t=function(t,r){if(null==t||0==t.length)return!0;var a,n=r.hasOwnProperty("dobValidateMaxDate")?r.dobValidateMaxDate:null,o=r.hasOwnProperty("dobValidateMinDate")?r.dobValidateMinDate:null,d=new Date,i=!0;if(void 0,void 0,void 0,"object"==typeof t?obj=t:obj=e.parseDob(t),day=obj.day,month=obj.month,year=obj.year,!(month&&year&&day))return!1;if(!/^\d+$/.test(day))return!1;if(!/^\d+$/.test(month))return!1;if(!/^\d+$/.test(year))return!1;if(a=new Date(year,month-1,day),a.getFullYear()!=year||a.getMonth()!=month-1||a.getDate()!=day)return!1;if(i=a<d,n&&i){var l=e.parseDate(n);d=new Date(l.year,l.month-1,l.day),i=a<d}if(o&&i){var u=e.parseDate(o);d=new Date(u.year,u.month-1,u.day),i=a>d}return i};return function(e,r,a,n){return t(e,n)}}]).directive("dobValidate",["$window","_ValidateDob",function(e,t){return{restrict:"A",require:"ngModel",link:function(e,r,a,n){var o=a.dobValidate,d=function(r){var d=t(r,n,e,a);return n.$setValidity(o,d),d?r:void 0};n.$formatters.push(d),n.$parsers.push(d)}}}]);